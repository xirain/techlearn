---
import BaseLayout from "./BaseLayout.astro";
import Tag from "@components/Tag.astro";
import type { CollectionEntry } from "astro:content";

interface Props {
  post: CollectionEntry<"posts">;
}

const { post } = Astro.props;
const { title, description, pubDatetime, tags } = post.data;

function formatDate(date: Date): string {
  return date.toLocaleDateString("zh-CN", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
}
---

<BaseLayout title={title} description={description}>
  <article class="container-custom py-12">
    <!-- Article Header -->
    <header class="mb-12 pb-8 border-b border-border">
      <div class="max-w-3xl">
        <time
          datetime={pubDatetime.toISOString()}
          class="text-sm text-muted-foreground"
        >
          {formatDate(pubDatetime)}
        </time>

        <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold mt-4 mb-6 leading-tight">
          {title}
        </h1>

        <p class="text-lg text-muted-foreground mb-6">
          {description}
        </p>

        <div class="flex flex-wrap gap-2">
          {tags.map((tag) => <Tag tag={tag} size="md" />)}
        </div>
      </div>
    </header>

    <!-- Article Content -->
    <div class="prose-custom max-w-3xl">
      <slot />
    </div>

    <!-- Back to Posts -->
    <div class="mt-16 pt-8 border-t border-border">
      <a
        href={`${import.meta.env.BASE_URL}/posts`}
        class="inline-flex items-center gap-2 text-muted-foreground hover:text-primary transition-colors"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="m12 19-7-7 7-7"></path>
          <path d="M19 12H5"></path>
        </svg>
        返回文章列表
      </a>
    </div>
  </article>
</BaseLayout>
